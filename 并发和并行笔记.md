# 番茄鱼的并发和并行笔记

并发是用于多个计算流程进行信息交换，以便协同完成信息同步/多用户交互等任务。

并行则是多个计算流程同时进行，尽可能互相不干扰，最终加速完成一个总的计算任务。

并发和并行在实现上有很多技术是交叉的，但是从概念上是两个不同的东西，针对不同的需求而提出的概念。

## 并发

并发的核心在于如何能够以可预期的方式进行信息交换。信息交换的主体是线程。信息交换的主要基本方式如下所列：
1. $send (x): A \to B$，单向传输。线程A计算好需要交换的信息然后传递到B，数据源可以是多个。此时接收方B只需要一个接收队列（加锁和无锁都可以实现）。
2. $modify (x,tag): A \to B \to B$，要求接收方按照接收的信息和内部的状态进行一个预定义的计算（tag），并更新内部的状态。预定义计算一般是简单高效的计算，可以直接用CPU指令完成。可以看成是对send的进一步封装，因为(x,tag)可以作为信息传输，然后接收方对tag进行解释，从而完成内部状态的更新。
3. $update (f,x,y) : A \to B \to A \to B$，双向交换信息。数据从A传输到B，B根据接收到的值计算需要回传的值，A接收后进行计算，结果再传到B。

总的来讲，就是进程演算中的信道进行消息传递。然而，消息传递与计算可以合并优化，否则一个简单的计算也要放入队列会导致额外的消耗。